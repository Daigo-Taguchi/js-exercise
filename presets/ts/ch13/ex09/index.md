## i1

### 予想

1秒後に42 が表示されたあとに、その2秒後に100 が表示される

### 結果

予想と同じ

### 理由

wait1().then(() => 42) で 1秒待機後に Promise が解決されるので、Primise.any() が解決され、
v = 42 となる。そして、42 が表示される
並行して、wait2().then(() => (v = 100)) が実行されているので、42 が表示された1秒後に v = 100 となる。
42 が表示されてから await wait2() で2秒待ってから v が再度表示されるので、そこで 100 が表示される。 Promise.any は最初に解決されているので、最後の 0 は無視される。

### 図解

```
Promise.any
wait1
|----|
     v=42
     |-|
       resolve
wait2
|----------------|
                v=100
                 |-|
                   v=0
                   |-|
                     resolve
        log(v)
        |-|
          wait2
          |----------------|
                           log(v)

```

## i2

### 予想

C -> B -> A -> [A,B,C] の順に表示される

### 結果

予想と同じ

### 理由

Promise.all で 3つの処理を並行処理がされて、すべての処理が終わるまで待機する。
1秒待機して C、2秒待機して B、3秒待機して A が出力される。
すべての処理が解決されると、Promise.all が解決されて、その結果が配列として出力される。

### 図解

```
Primise.all
wait1
|----|
     logC
     |-|
       return C
wait2
|--------|
         logB
         |-|
           return B
wait3
|------------|
             logA
             |-|
               return A
               log(["A", "B", "C"])
```

## i3

### 予想

Y -> 42 ->　B -> 0 の順で出力される

### 結果

予想と同じ

### 理由

Promise.all の中の処理でエラーが発生したらすぐに catch 節が実行される。
しかし、他の Promise の処理は止まらないので同時に実行される。

### 図解

```
v=42
wait3
|------------|
             v=0
             errX
wait2
|--------|
         logB
         |-|
           return B
wait1
|----|
     errY
      |
      catch
      |
      log(e.message)
      |-|
        log(v)
        |-|
          wait3
          |------------|
                       log(v)
```

## i4

### 予想

0,1,2,3,4 と順に表示され、最後に COMPLETED が表示される

### 結果

予想と同じ

### 理由

for 文で promise が順番に実行される

### 図解

```
wait5
|--------------------|
                     log(0)
                     |-|
                       wait4
                       |----------------|
                                        log(1)
                                        |-|
                                          wait3
                                          |------------|
                                                       log(2)
                                                       |-|
                                                         wait2
                                                         |--------|
                                                                  log(1)
                                                                  |-|
                                                                    wait1
                                                                    |----|
                                                                         log(0)
                                                                         |-|
                                                                           log("COMPLETED")
```

## i5

TS だと ` p = p.then(wait((5 - i) * 1000).then(() => log(i)));` の部分で型エラーとなる

## i6

### 予想

4,3,2,1 と表示されたあとに COMPLETED が表示される

### 結果

予想と同じ

### 理由

Promise.all により[0,1,2,3,4].map の処理が並行で実行される
wait の時間が i の数値が大きいほど短くなるので、iの数値が大きい順に表示される

### 図解

```
wait5
|---------------------|
                      log(0)
                      |-|
                        log("COMPLETED")
wait4
|----------------|
                 log(1)
wait3
|------------|
             log(2)
wait2
|--------|
         log(3)
wait1
|----|
     log(4)
```

## i7

### 予想

10 が表示される

### 結果

予想と同じ

### 理由

p1 と p2 が Promise.all で並行実行される。
両方ので共通の v を更新しているので、交互に1ずつ増加していき、p2 で v が最後に更新されたあとに
Promise.all が解決され、v に 10 が格納されているので、それが表示される

### 図解

```
next = 0 + 1
v = 1

wait2
|--------|
         next = 2 + 1
         v = 3
         wait2
         |--------|
                  next = 4 + 1
                  v = 5
                  wait2
                  |--------|
                           next = 6 + 1
                           v = 7
                           wait2
                           |--------|
                                    next = 8 + 1
                                    v = 9
                                    wait2
                                    |--------|
wait1
|----|
     next = 1 + 1
     v = 2
     wait2
     |--------|
              next = 3 + 1
              v = 4
              wait2
              |--------|
                       next = 5 + 1
                       v = 6
                       wait2
                       |--------|
                                next = 7 + 1
                                v = 8
                                wait2
                                |--------|
                                         next = 9 + 1
                                         v = 10
                                         wait2
                                         |--------|
                                                  log(v)
```

## i8

### 予想

5 が表示される

### 結果

予想と同じ

### 図解

```
<p1>
wait1
|----|
     next = 0 + 1
     wait2
     |--------|
              v = 1
              next = 1 + 1
              wait2
              |--------|
                       v = 2
                       next = 2 + 1
                       wait2
                       |--------|
                                v = 3
                                next = 3 + 1
                                wait2
                                |--------|
                                         v = 4
                                         next = 4 + 1
                                         wait2
                                         |--------|
                                                  v = 5
                                                  log(v)
<p2>
next = 0 + 1
wait2
|--------|
         v = 1
         next = 1 + 1
         wait2
         |--------|
                  v = 2
                  next = 2 + 1
                  wait2
                  |--------|
                           v = 3
                           next = 3 + 1
                           wait2
                           |--------|
                                    v = 4
                                    next = 4 + 1
                                    wait2
                                    |--------|
                                             v = 5

```
